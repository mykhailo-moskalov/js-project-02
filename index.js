import{a as f,i as a,I as S,A as x,S as B,R as q}from"./assets/vendor-D53ZmN9k.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();const y=document.querySelector(".categories"),b=document.querySelector(".furniture-list"),v=document.querySelector(".loader"),p=document.querySelector(".show-more-btn"),M=document.querySelector(".all-category");let L="",c=1,n;p.addEventListener("click",O);y.addEventListener("click",$);R().then(e=>{A(e)});g(c).then(e=>{n=e.totalItems,n-=e.furnitures.length,u(e.furnitures),h(),m()});async function R(){return(await f.get("https://furniture-store.b.goit.study/api/categories")).data}function A(e){y.insertAdjacentHTML("beforeend",e.map(({name:s,_id:o})=>`<li class="categories-item" ><button class="categories-btn" id="${o}">${s}</button></li>`).join("")),e.forEach(({_id:s})=>{}),document.querySelectorAll(".categories-btn").forEach(s=>{switch(s.textContent.trim()){case"М'які меблі":s.classList.add("soft-category");break;case"Шафи та системи зберігання":s.classList.add("storage-category");break;case"Ліжка та матраци":s.classList.add("beds-category");break;case"Столи":s.classList.add("tabels-category");break;case"Стільці та табурети":s.classList.add("chairs-category");break;case"Кухні":s.classList.add("kitchens-category");break;case"Меблі для дитячої":s.classList.add("nursery-category");break;case"Меблі для офісу":s.classList.add("office-category");break;case"Меблі для передпокою":s.classList.add("hallway-category");break;case"Меблі для ванної кімнати":s.classList.add("bathroom-category");break;case"Садові та вуличні меблі":s.classList.add("garden-category");break;case"Декор та аксесуари":s.classList.add("decor-category");break;default:s.classList.add("category")}})}async function E(e,t){return(await f.get("https://furniture-store.b.goit.study/api/furnitures",{params:{category:e,page:t,limit:8}})).data}async function g(e){return(await f.get("https://furniture-store.b.goit.study/api/furnitures",{params:{limit:8,page:e}})).data}async function $(e){if(e.preventDefault(),P(),c=1,k(),d(),e.target.classList.contains("categories-btn")&&(document.querySelectorAll(".categories-btn.accent").forEach(t=>{t.classList.remove("accent")}),e.target.classList.add("accent")),e.target!==e.currentTarget)if(e.target.id==="all-categories")try{const t=await g(c);n=t.totalItems,n-=t.furnitures.length,u(t.furnitures),h(),m()}catch(t){a.show({message:t.message,messageColor:"white",backgroundColor:"red",maxWidth:"432px",close:!0,position:"topRight"})}else{L=e.target.id;try{const t=await E(e.target.id,c);n=t.totalItems,n-=t.furnitures.length,u(t.furnitures),h(),m(),n||d()}catch(t){a.show({message:t.message,messageColor:"white",backgroundColor:"red",maxWidth:"432px",close:!0,position:"topRight"})}}}function u(e){b.insertAdjacentHTML("beforeend",e.map(({images:t,name:s,price:o,_id:r,color:i,description:l})=>`<li class="furniture-list-item">
        <img class="furniture-item-img" src="${t[0]}" alt="${l}">
        <h4 class="furniture-item-name">${s}</h4>
        <div class="furniture-colors">
        ${i.map(C=>`<span class="item-color" style="background-color: ${C};"></span>`).join("")}
        </div>
        <p class="furniture-item-price">${o} грн</p>
        <button class="furniture-details-btn" id="${r}">Детальніше</button>
        </li>`).join(""))}function m(){p.classList.remove("visually-hidden")}function d(){p.classList.add("visually-hidden")}function k(){v.classList.remove("visually-hidden")}function h(){v.classList.add("visually-hidden")}function P(){b.innerHTML=""}async function O(e){if(d(),k(),c++,p.blur(),M.classList.contains("accent"))try{const t=await g(c);u(t.furnitures),h(),m(),n-=t.furnitures.length,n||(d(),a.info({message:"We're sorry, but you've reached the end of search results.",position:"topRight"}));const s=document.querySelector(".furniture-list-item");if(s){const o=s.getBoundingClientRect().height;window.scrollBy({top:o,behavior:"smooth"})}}catch(t){a.show({message:t.message,messageColor:"white",backgroundColor:"red",maxWidth:"432px",close:!0,position:"topRight"})}else try{const t=await E(L,c);u(t.furnitures),h(),m(),n-=t.furnitures.length,n||(d(),a.info({message:"We're sorry, but you've reached the end of search results.",position:"topRight"}));const s=document.querySelector(".furniture-list-item");if(s){const o=s.getBoundingClientRect().height;window.scrollBy({top:o,behavior:"smooth"})}}catch(t){a.show({message:t.message,messageColor:"white",backgroundColor:"red",maxWidth:"432px",close:!0,position:"topRight"})}}const T="https://furniture-store.b.goit.study/api/orders",w={refs:{openBtn:document.getElementById("test-open-modal"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),form:document.getElementById("order-form"),emailInput:document.getElementById("order-email"),phoneInput:document.getElementById("order-phone"),emailError:document.getElementById("email-error"),phoneError:document.getElementById("phone-error"),commentInput:document.getElementById("order-comment"),commentError:document.getElementById("comment-error")},modelId:"682f9bbf8acbdf505592ac36",color:"#1212ca",init(){if(!this.checkElements()){console.error("Не всі необхідні елементи знайдено");return}this.refs.openBtn.addEventListener("click",this.openModal.bind(this)),this.refs.closeModalBtn.addEventListener("click",this.closeModal.bind(this)),this.refs.modal.addEventListener("click",this.backdropClick.bind(this)),document.addEventListener("keydown",this.keydownHandler.bind(this)),this.refs.form.addEventListener("submit",this.handleSubmit.bind(this)),this.refs.emailInput.addEventListener("input",this.validateEmail.bind(this)),this.refs.phoneInput.addEventListener("input",this.validatePhone.bind(this)),this.refs.commentInput.addEventListener("input",this.validateComment.bind(this))},checkElements(){return[this.refs.openBtn,this.refs.closeModalBtn,this.refs.modal,this.refs.form,this.refs.emailInput,this.refs.phoneInput,this.refs.emailError,this.refs.phoneError,this.refs.commentInput,this.refs.commentError].every(t=>t!==null)},openModal(){document.body.classList.add("modal-open"),this.refs.modal.classList.remove("visually-hidden")},closeModal(){document.body.classList.remove("modal-open"),this.refs.modal.classList.add("visually-hidden"),this.refs.form.reset(),this.clearValidationStyles()},backdropClick(e){e.target===e.currentTarget&&this.closeModal()},keydownHandler(e){e.code==="Escape"&&this.closeModal()},validateEmail(){const e=this.refs.emailInput.value.trim();return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(e)?(this.refs.emailInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",!0):(this.markInvalid(this.refs.emailInput),this.refs.emailError.textContent="Пошта повинна бути у форматі example@email.com",this.refs.emailError.style.display="block",!1)},validatePhone(){const e=this.refs.phoneInput.value.trim();return/^\+38\s\(\d{3}\)\s\d{3}\s\d{2}\s\d{2}$/.test(e)?(this.refs.phoneInput.classList.remove("invalid"),this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",!0):(this.markInvalid(this.refs.phoneInput),this.refs.phoneError.textContent="Телефон має бути у форматі +38 (0XX) XXX XX XX",this.refs.phoneError.style.display="block",!1)},formatPhoneNumber(e){return e.replace(/\D/g,"")},validateComment(){const e=this.refs.commentInput.value.trim();return e&&(e.length<5||e.length>256)?(this.markInvalid(this.refs.commentInput),this.refs.commentError.textContent="Коментар має містити від 5 до 256 символів",this.refs.commentError.style.display="block",!1):(this.refs.commentInput.classList.remove("invalid"),this.refs.commentError.textContent="",this.refs.commentError.style.display="none",!0)},async handleSubmit(e){e.preventDefault(),this.clearValidationStyles();let t=!0;if(this.validateEmail()||(t=!1),this.validatePhone()||(t=!1),this.validateComment()||(t=!1),!t){a.error({title:"Помилка",message:"Будь ласка, виправте помилки у формі",position:"topRight"});return}const s={email:this.refs.emailInput.value.trim(),phone:this.formatPhoneNumber(this.refs.phoneInput.value.trim()),modelId:this.modelId,color:this.color},o=this.refs.commentInput.value.trim();o&&(s.comment=o),console.log("Відправляємо дані:",s);try{const r=await fetch(T,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const i=await r.json();throw new Error(i.message||"Не вдалося відправити заявку")}a.success({title:"Успіх",message:"Ваша заявка відправлена!",position:"topRight"}),this.closeModal()}catch(r){console.error("Помилка при відправці:",r),a.error({title:"Помилка",message:r.message||"Помилка зʼєднання з сервером",position:"topRight"})}},markInvalid(e){e.classList.add("invalid")},clearValidationStyles(){this.refs.emailInput.classList.remove("invalid"),this.refs.phoneInput.classList.remove("invalid"),this.refs.commentInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",this.refs.commentError.textContent="",this.refs.commentError.style.display="none"}};S(w.refs.phoneInput,{mask:"+38 (0\\00) 000 00 00"});document.addEventListener("DOMContentLoaded",()=>{w.init()});new x(".accordion-container",{});function j(){document.querySelector(".loader").classList.remove("hidden")}function X(){document.querySelector(".loader").classList.add("hidden")}const I=document.querySelector(".feedback-swiper"),H=new B(I,{pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"},slidesPerView:1,spaceBetween:16,breakpoints:{768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3}}});F();async function F(){j();try{const e=await N();V(e),H.update()}catch(e){a.error({title:"Помилка",message:"Не вдалося завантажити галерею відгуків. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedback:",e)}finally{X()}}async function V(e){const t=e.map(s=>`
<li class="feedback-swiper-slide swiper-slide">
  <div class="rating-list" data-score="${s.rate}"></div>
  <p class="feedback-slide-text">"${s.descr}"</p>
  <p class="feedback-slide-name">${s.name}</p>
</li>
`).join("");I.querySelector(".swiper-wrapper").insertAdjacentHTML("beforeend",t),document.querySelectorAll(".rating-list").forEach(s=>{const o=parseFloat(s.dataset.score);new q(s,{round:{down:.25,full:.75,up:.76},readOnly:!0,score:o,starType:"i"}).init()})}async function N(){try{return(await f.get("https://furniture-store.b.goit.study/api/feedbacks",{params:{page:1,limit:10}})).data.feedbacks}catch(e){a.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedbacks:",e)}}const W=document.querySelectorAll("button"),D=document.querySelectorAll("a"),z=["click","mousedown","mouseleave","mouseup","mouseleave","touchstart","touchmove","touchend","touchcancel"];z.forEach(e=>{W.forEach(t=>{t.addEventListener(e,()=>{t.focus(),t.blur()})}),D.forEach(t=>{t.addEventListener(e,()=>{t.focus(),t.blur()})})});
//# sourceMappingURL=index.js.map
