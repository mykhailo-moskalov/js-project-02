import{I as c,i as n,S as m,R as h,a as p}from"./assets/vendor-CmegGP3q.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))o(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function i(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(t){if(t.ep)return;t.ep=!0;const s=i(t);fetch(t.href,s)}})();const f="https://furniture-store.b.goit.study/api/orders",l={refs:{openBtn:document.getElementById("test-open-modal"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),form:document.getElementById("order-form"),emailInput:document.getElementById("order-email"),phoneInput:document.getElementById("order-phone"),emailError:document.getElementById("email-error"),phoneError:document.getElementById("phone-error"),commentInput:document.getElementById("order-comment"),commentError:document.getElementById("comment-error")},modelId:"682f9bbf8acbdf505592ac36",color:"#1212ca",init(){if(!this.checkElements()){console.error("Не всі необхідні елементи знайдено");return}this.refs.openBtn.addEventListener("click",this.openModal.bind(this)),this.refs.closeModalBtn.addEventListener("click",this.closeModal.bind(this)),this.refs.modal.addEventListener("click",this.backdropClick.bind(this)),document.addEventListener("keydown",this.keydownHandler.bind(this)),this.refs.form.addEventListener("submit",this.handleSubmit.bind(this)),this.refs.emailInput.addEventListener("input",this.validateEmail.bind(this)),this.refs.phoneInput.addEventListener("input",this.validatePhone.bind(this)),this.refs.commentInput.addEventListener("input",this.validateComment.bind(this))},checkElements(){return[this.refs.openBtn,this.refs.closeModalBtn,this.refs.modal,this.refs.form,this.refs.emailInput,this.refs.phoneInput,this.refs.emailError,this.refs.phoneError,this.refs.commentInput,this.refs.commentError].every(r=>r!==null)},openModal(){document.body.classList.add("modal-open"),this.refs.modal.classList.remove("visually-hidden")},closeModal(){document.body.classList.remove("modal-open"),this.refs.modal.classList.add("visually-hidden"),this.refs.form.reset(),this.clearValidationStyles()},backdropClick(e){e.target===e.currentTarget&&this.closeModal()},keydownHandler(e){e.code==="Escape"&&this.closeModal()},validateEmail(){const e=this.refs.emailInput.value.trim();return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(e)?(this.refs.emailInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",!0):(this.markInvalid(this.refs.emailInput),this.refs.emailError.textContent="Пошта повинна бути у форматі example@email.com",this.refs.emailError.style.display="block",!1)},validatePhone(){const e=this.refs.phoneInput.value.trim();return/^\+38\s\(\d{3}\)\s\d{3}\s\d{2}\s\d{2}$/.test(e)?(this.refs.phoneInput.classList.remove("invalid"),this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",!0):(this.markInvalid(this.refs.phoneInput),this.refs.phoneError.textContent="Телефон має бути у форматі +38 (0XX) XXX XX XX",this.refs.phoneError.style.display="block",!1)},formatPhoneNumber(e){return e.replace(/\D/g,"")},validateComment(){const e=this.refs.commentInput.value.trim();return e&&(e.length<5||e.length>256)?(this.markInvalid(this.refs.commentInput),this.refs.commentError.textContent="Коментар має містити від 5 до 256 символів",this.refs.commentError.style.display="block",!1):(this.refs.commentInput.classList.remove("invalid"),this.refs.commentError.textContent="",this.refs.commentError.style.display="none",!0)},async handleSubmit(e){e.preventDefault(),this.clearValidationStyles();let r=!0;if(this.validateEmail()||(r=!1),this.validatePhone()||(r=!1),this.validateComment()||(r=!1),!r){n.error({title:"Помилка",message:"Будь ласка, виправте помилки у формі",position:"topRight"});return}const i={email:this.refs.emailInput.value.trim(),phone:this.formatPhoneNumber(this.refs.phoneInput.value.trim()),modelId:this.modelId,color:this.color},o=this.refs.commentInput.value.trim();o&&(i.comment=o),console.log("Відправляємо дані:",i);try{const t=await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!t.ok){const s=await t.json();throw new Error(s.message||"Не вдалося відправити заявку")}n.success({title:"Успіх",message:"Ваша заявка відправлена!",position:"topRight"}),this.closeModal()}catch(t){console.error("Помилка при відправці:",t),n.error({title:"Помилка",message:t.message||"Помилка зʼєднання з сервером",position:"topRight"})}},markInvalid(e){e.classList.add("invalid")},clearValidationStyles(){this.refs.emailInput.classList.remove("invalid"),this.refs.phoneInput.classList.remove("invalid"),this.refs.commentInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",this.refs.commentError.textContent="",this.refs.commentError.style.display="none"}};c(l.refs.phoneInput,{mask:"+38 (0\\00) 000 00 00"});document.addEventListener("DOMContentLoaded",()=>{l.init()});function u(){document.querySelector(".loader").classList.remove("hidden")}function y(){document.querySelector(".loader").classList.add("hidden")}const d=document.querySelector(".feedback-swiper"),E=new m(d,{pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"},slidesPerView:1,spaceBetween:16,breakpoints:{768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3}}});v();async function v(){u();try{const e=await b();g(e),E.update()}catch(e){n.error({title:"Помилка",message:"Не вдалося завантажити галерею відгуків. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedback:",e)}finally{y()}}async function g(e){const r=e.map(i=>`
<li class="feedback-swiper-slide swiper-slide">
  <div class="rating-list" data-score="${i.rate}"></div>
  <p class="feedback-slide-text">"${i.descr}"</p>
  <p class="feedback-slide-name">${i.name}</p>
</li>
`).join("");d.querySelector(".swiper-wrapper").insertAdjacentHTML("beforeend",r),document.querySelectorAll(".rating-list").forEach(i=>{const o=parseFloat(i.dataset.score);new h(i,{round:{down:.25,full:.75,up:.76},readOnly:!0,score:o,starType:"i"}).init()})}async function b(){try{return(await p.get("https://furniture-store.b.goit.study/api/feedbacks",{params:{page:1,limit:10}})).data.feedbacks}catch(e){n.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedbacks:",e)}}
//# sourceMappingURL=index.js.map
