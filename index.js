import{i as d,a as y,I as R,A as F,S as O,R as H}from"./assets/vendor-DzXFeRzo.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const c of n.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();window.addEventListener("DOMContentLoaded",()=>{const t=document.querySelector("[data-mobile-menu]"),e=document.querySelector("[data-mobile-menu-open]"),s=document.querySelector("[data-mobile-menu-close]"),i=document.querySelectorAll(".mobile-menu__link"),r=document.body;if(!t||!e)return;const n=new URL("img/sprite.svg",document.baseURI).pathname,c=(e.dataset.sprite||n).trim(),m=(e.dataset.iconClosed||"menu").trim(),A=(e.dataset.iconOpen||"x").trim(),b=a=>{const u=e.querySelector("svg");if(!u)return;const v=`${c}#${a}`,w="http://www.w3.org/2000/svg",$="http://www.w3.org/1999/xlink",C=u.querySelector("use");C&&u.removeChild(C);const E=document.createElementNS(w,"use");try{E.setAttribute("href",v)}catch{}try{E.setAttributeNS($,"xlink:href",v)}catch{}u.appendChild(E)},X=()=>{t.classList.add("is-open"),t.setAttribute("aria-hidden","false"),e.setAttribute("aria-expanded","true"),r.classList.add("no-scroll"),b(A),e.setAttribute("aria-label","Закрити меню")},f=()=>{t.classList.remove("is-open"),t.setAttribute("aria-hidden","true"),e.setAttribute("aria-expanded","false"),r.classList.remove("no-scroll"),b(m),e.setAttribute("aria-label","Відкрити меню")};e.addEventListener("click",a=>{a.preventDefault(),e.getAttribute("aria-expanded")==="true"?f():X()}),s&&s.addEventListener("click",f),i.forEach(a=>a.addEventListener("click",f)),window.addEventListener("keydown",a=>{a.key==="Escape"&&f()}),document.addEventListener("click",a=>{const u=window.innerWidth;if(u>=768&&u<1440&&t.classList.contains("is-open")){const v=t.contains(a.target),w=e.contains(a.target)||s&&s.contains(a.target);!v&&!w&&f()}}),b(m)});const N=`<li class="furniture-item" id="{idCat}">
  <div class="furniture-item-content">
    <h3 class="furniture-item-title">{nameCat}</h3>
  </div>
  <img
    srcset="
      /public/img/webp/categories/category-{numCat}.webp        1x,
      /public/img/webp/categories@2x/category-{numCat}@2x.webp 2x
    "
    src="/public/img/webp/categories/category-{numCat}.webp"
    alt="{altCat}"
    class="furniture-item-image"
  />
</li>`,_=`<li class="furniture-card">
  <img class="furniture-card-img" src="{srcFrn}" alt="{altFrn}" />
  <div class="furniture-card-propeties">
    <p class="furniture-card-name">{nameFrn}</p>
    <div class="furniture-card-colors">{colorHtml}</div>
    <p class="furniture-card-cost">{priceFrn} грн</p>
  </div>
  <button id="{idFrn}" class="furniture-card-button">Детальніше</button>
</li>`;async function j(t,e,s){try{return(await y.get("https://furniture-store.b.goit.study/api/categories",{})).data}catch{return[]}}async function z(t=1,e="",s){try{const i={page:t,limit:s};return e&&e!=="all-categories"&&(i.category=e),(await y.get("https://furniture-store.b.goit.study/api/furnitures",{params:i})).data}catch{return[]}}async function U(t){const e=[{_id:"all-categories",name:"Всі товари"},...t];let s=1;const i=e.map(n=>{let c=N.replace("{idCat}",n._id).replace("{nameCat}",n.name).replace("{altCat}",n.name).replaceAll("{numCat}",s);return s++,c}).join("");document.querySelector(".furniture-categories").insertAdjacentHTML("beforeend",i),P("all-categories")}async function W(){try{const t=await j();return await U(t),t}catch{return d.error({title:"Error",message:"Не удалось загрузить категории. Попробуйте позже!",position:"topRight"}),[]}}function L(){B.style.display="inline-block"}function S(){B.style.display="none"}function K(){p.style.display="block"}function h(){p.style.display="none"}function k(){q.style.display="block"}function M(){q.style.display="none"}async function x(t,e="",s,i){try{const r=await z(t,e,s);return await Z(r.furnitures,i),r}catch{return h(),d.error({title:"Error",message:"Не удалось загрузить товары. Попробуйте позже!",position:"topRight"}),[]}}async function Z(t,e){const s=t.map(r=>{let n="";return r.color.forEach(m=>{n+=`<span class="furniture-card-color-chek" style="display: inline-block; background-color: ${m};"></span>`}),_.replace("{srcFrn}",r.images[0]).replace("{nameFrn}",r.name).replace("{priceFrn}",r.price).replace("{idFrn}",r._id).replace("{altFrn}",r.description).replace("{colorHtml}",n)}).join("");document.querySelector(e).insertAdjacentHTML("beforeend",s),K()}function P(t){document.querySelectorAll(".furniture-item-content").forEach(i=>{i.style.border="",i.style.borderRadius=""});const s=document.getElementById(t).querySelector(".furniture-item-content");s.style.border="8px solid #6b0609",s.style.borderRadius="8px"}const o=8;let g="all-categories",l=1;const p=document.querySelector(".furniture-load-more"),q=document.querySelector(".furniture-load-no"),B=document.querySelector(".loader");M();h();L();W();x(l,g,o,".furniture-cards").then(t=>{const e=t.totalItems-l*o;p.textContent=`Показати ще ${o} з ${e}`,l*o>=t.totalItems&&(h(),k()),S()});const J=document.querySelector(".furniture-categories");J.addEventListener("click",t=>{M(),h(),l=1,g=t.target.closest(".furniture-item").getAttribute("id"),document.querySelector(".furniture-cards").innerHTML="",L(),x(l,g,o,".furniture-cards").then(e=>{P(g);const s=e.totalItems-l*o;let i=o<=s?o:s;p.textContent=`Показати ще ${i} з ${s}`,l*o>=e.totalItems&&(h(),k()),S()})});p.addEventListener("click",()=>{h(),L(),l++,x(l,g,o,".furniture-cards").then(t=>{const e=t.totalItems-l*o;let s=o<=e?o:e;p.textContent=`Показати ще ${s} з ${e}`,l*o>=t.totalItems&&(h(),k()),S()})});const Q="https://furniture-store.b.goit.study/api/orders",T={refs:{openBtn:document.getElementById("test-open-modal"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),form:document.getElementById("order-form"),emailInput:document.getElementById("order-email"),phoneInput:document.getElementById("order-phone"),emailError:document.getElementById("email-error"),phoneError:document.getElementById("phone-error"),commentInput:document.getElementById("order-comment"),commentError:document.getElementById("comment-error")},modelId:"682f9bbf8acbdf505592ac36",color:"#1212ca",init(){if(!this.checkElements()){console.error("Не всі необхідні елементи знайдено");return}this.refs.openBtn.addEventListener("click",this.openModal.bind(this)),this.refs.closeModalBtn.addEventListener("click",this.closeModal.bind(this)),this.refs.modal.addEventListener("click",this.backdropClick.bind(this)),document.addEventListener("keydown",this.keydownHandler.bind(this)),this.refs.form.addEventListener("submit",this.handleSubmit.bind(this)),this.refs.emailInput.addEventListener("input",this.validateEmail.bind(this)),this.refs.phoneInput.addEventListener("input",this.validatePhone.bind(this)),this.refs.commentInput.addEventListener("input",this.validateComment.bind(this))},checkElements(){return[this.refs.openBtn,this.refs.closeModalBtn,this.refs.modal,this.refs.form,this.refs.emailInput,this.refs.phoneInput,this.refs.emailError,this.refs.phoneError,this.refs.commentInput,this.refs.commentError].every(e=>e!==null)},openModal(){document.body.style.overflow="hidden",document.body.classList.add("modal-open"),this.refs.modal.classList.remove("visually-hidden")},closeModal(){document.body.style.overflow="",document.body.classList.remove("modal-open"),this.refs.modal.classList.add("visually-hidden"),this.refs.form.reset(),this.clearValidationStyles()},backdropClick(t){t.target===t.currentTarget&&this.closeModal()},keydownHandler(t){t.code==="Escape"&&this.closeModal()},validateEmail(){const t=this.refs.emailInput.value.trim();return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(t)?(this.refs.emailInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",!0):(this.markInvalid(this.refs.emailInput),this.refs.emailError.textContent="Пошта повинна бути у форматі example@email.com",this.refs.emailError.style.display="block",!1)},validatePhone(){const t=this.refs.phoneInput.value.trim();return/^\+38\s\(\d{3}\)\s\d{3}\s\d{2}\s\d{2}$/.test(t)?(this.refs.phoneInput.classList.remove("invalid"),this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",!0):(this.markInvalid(this.refs.phoneInput),this.refs.phoneError.textContent="Телефон має бути у форматі +38 (0XX) XXX XX XX",this.refs.phoneError.style.display="block",!1)},formatPhoneNumber(t){return t.replace(/\D/g,"")},validateComment(){const t=this.refs.commentInput.value.trim();return t&&(t.length<5||t.length>256)?(this.markInvalid(this.refs.commentInput),this.refs.commentError.textContent="Коментар має містити від 5 до 256 символів",this.refs.commentError.style.display="block",!1):(this.refs.commentInput.classList.remove("invalid"),this.refs.commentError.textContent="",this.refs.commentError.style.display="none",!0)},async handleSubmit(t){t.preventDefault(),this.clearValidationStyles();let e=!0;if(this.validateEmail()||(e=!1),this.validatePhone()||(e=!1),this.validateComment()||(e=!1),!e){d.error({title:"Помилка",message:"Будь ласка, виправте помилки у формі",position:"topRight"});return}const s={email:this.refs.emailInput.value.trim(),phone:this.formatPhoneNumber(this.refs.phoneInput.value.trim()),modelId:this.modelId,color:this.color},i=this.refs.commentInput.value.trim();i&&(s.comment=i),console.log("Відправляємо дані:",s);try{const r=await fetch(Q,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!r.ok){const n=await r.json();throw new Error(n.message||"Не вдалося відправити заявку")}d.success({title:"Успіх",message:"Ваша заявка відправлена!",position:"topRight"}),this.closeModal()}catch(r){console.error("Помилка при відправці:",r),d.error({title:"Помилка",message:r.message||"Помилка зʼєднання з сервером",position:"topRight"})}},markInvalid(t){t.classList.add("invalid")},clearValidationStyles(){this.refs.emailInput.classList.remove("invalid"),this.refs.phoneInput.classList.remove("invalid"),this.refs.commentInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",this.refs.commentError.textContent="",this.refs.commentError.style.display="none"}};R(T.refs.phoneInput,{mask:"+38 (0\\00) 000 00 00"});document.addEventListener("DOMContentLoaded",()=>{T.init()});new F(".accordion-container",{});function G(){document.querySelector(".loader").classList.remove("hidden")}function Y(){document.querySelector(".loader").classList.add("hidden")}const D=document.querySelector(".feedback-swiper"),ee=new O(D,{pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"},slidesPerView:1,spaceBetween:16,breakpoints:{768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3}}});te();async function te(){G();try{const t=await re();se(t),ee.update()}catch(t){d.error({title:"Помилка",message:"Не вдалося завантажити галерею відгуків. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedback:",t)}finally{Y()}}async function se(t){const e=t.map(s=>`
<li class="feedback-swiper-slide swiper-slide">
  <div class="rating-list" data-score="${s.rate}"></div>
  <p class="feedback-slide-text">"${s.descr}"</p>
  <p class="feedback-slide-name">${s.name}</p>
</li>
`).join("");D.querySelector(".swiper-wrapper").insertAdjacentHTML("beforeend",e),document.querySelectorAll(".rating-list").forEach(s=>{const i=parseFloat(s.dataset.score);new H(s,{round:{down:.25,full:.75,up:.76},readOnly:!0,score:i,starType:"i"}).init()})}async function re(){try{return(await y.get("https://furniture-store.b.goit.study/api/feedbacks",{params:{page:1,limit:10}})).data.feedbacks}catch(t){d.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedbacks:",t)}}const ie=document.querySelectorAll("button"),ne=document.querySelectorAll("a"),oe=["click","mousedown","mouseleave","mouseup","mouseleave","touchstart","touchmove","touchend","touchcancel"];oe.forEach(t=>{ie.forEach(e=>{e.addEventListener(t,()=>{e.blur()})}),ne.forEach(e=>{e.addEventListener(t,()=>{e.blur()})})});class I{constructor(){this.container=document.querySelector(".popular-container"),this.track=document.querySelector(".popular-slider-track"),this.prevBtn=document.querySelector(".slider-btn-prev"),this.nextBtn=document.querySelector(".slider-btn-next"),this.dotsContainer=document.querySelector(".slider-dots"),this.slider=document.querySelector(".popular-slider"),this.currentIndex=0,this.itemsPerView=this.getItemsPerView(),this.totalItems=0,this.items=[],this.isLoading=!1,this.touchStartX=0,this.touchEndX=0,this.isDragging=!1,this.startTransform=0,this.currentTransform=0,this.init()}async init(){this.container&&(this.bindEvents(),await this.loadPopularItems(),this.setupResponsive())}bindEvents(){this.prevBtn?.addEventListener("click",()=>this.prevSlide()),this.nextBtn?.addEventListener("click",()=>this.nextSlide()),this.slider?.addEventListener("touchstart",e=>this.handleTouchStart(e),{passive:!0}),this.slider?.addEventListener("touchmove",e=>this.handleTouchMove(e),{passive:!1}),this.slider?.addEventListener("touchend",e=>this.handleTouchEnd(e),{passive:!0}),this.slider?.addEventListener("mousedown",e=>this.handleMouseDown(e)),this.slider?.addEventListener("mousemove",e=>this.handleMouseMove(e)),this.slider?.addEventListener("mouseup",e=>this.handleMouseUp(e)),this.slider?.addEventListener("mouseleave",e=>this.handleMouseUp(e)),this.slider?.addEventListener("dragstart",e=>e.preventDefault()),document.addEventListener("keydown",e=>this.handleKeyPress(e)),window.addEventListener("resize",()=>this.handleResize())}async loadPopularItems(){if(!this.isLoading){this.isLoading=!0;try{const e=await y.get("https://furniture-store.b.goit.study/api/furnitures",{params:{limit:12,page:1}});this.items=e.data.furnitures||[],this.totalItems=this.items.length,this.renderItems(),this.renderDots(),this.updateSlider()}catch(e){console.error("Error loading popular items:",e),d.error({title:"Помилка",message:"Не вдалося завантажити популярні товари",position:"topRight"})}finally{this.isLoading=!1}}}renderItems(){if(!this.track||!this.items.length)return;const e=this.items.slice(-this.itemsPerView),s=this.items.slice(0,this.itemsPerView),i=[...e,...this.items,...s],r=i.map(n=>this.createItemHTML(n)).join("");this.track.innerHTML=r,this.totalItems=i.length,this.currentIndex=this.itemsPerView,this.updateSlider(!0),this.track.querySelectorAll(".popular-details-btn").forEach(n=>{n.addEventListener("click",c=>{const m=c.target.dataset.id;this.openItemDetails(m)})})}createItemHTML(e){const i=(e.color||[]).map(r=>`<span class="popular-color" style="background-color: ${r};"></span>`).join("");return`
      <div class="popular-item">
        <img class="popular-item-img" src="${e.images?.[0]||""}" alt="${e.name||""}" loading="lazy">
        <h3 class="popular-item-name">${e.name||""}</h3>
        <div class="popular-item-colors">${i}</div>
        <p class="popular-item-price">${e.price||0} грн</p>
        <button class="popular-details-btn" data-id="${e._id}">Детальніше</button>
      </div>
    `}renderDots(){if(!this.dotsContainer)return;const e=Math.ceil(this.items.length/this.itemsPerView),s=Array.from({length:e},(i,r)=>`<button class="slider-dot ${r===0?"active":""}" data-slide="${r}"></button>`).join("");this.dotsContainer.innerHTML=s,this.dotsContainer.querySelectorAll(".slider-dot").forEach(i=>{i.addEventListener("click",r=>{const n=parseInt(r.target.dataset.slide);this.currentIndex=n+this.itemsPerView,this.updateSlider()})})}getItemsPerView(){const e=window.innerWidth;return e>=1440?4:e>=768?2:1}updateSlider(e=!1){if(!this.track)return;const s=100/this.itemsPerView,i=-this.currentIndex*s;e?this.track.style.transition="none":this.track.style.transition="transform 0.3s ease",this.track.style.transform=`translateX(${i}%)`,this.currentTransform=i,this.updateDots()}updateButtons(){if(!this.prevBtn||!this.nextBtn)return;const e=Math.max(0,Math.ceil(this.totalItems/this.itemsPerView)-1);this.prevBtn.disabled=this.currentIndex<=0,this.nextBtn.disabled=this.currentIndex>=e}updateDots(){if(!this.dotsContainer)return;const e=Math.ceil(this.items.length/this.itemsPerView);let s=(this.currentIndex-this.itemsPerView)%e;s<0&&(s+=e),this.dotsContainer.querySelectorAll(".slider-dot").forEach((i,r)=>{i.classList.toggle("active",r===s)})}nextSlide(){this.currentIndex++,this.updateSlider(),this.currentIndex>=this.totalItems-this.itemsPerView&&setTimeout(()=>{this.currentIndex=this.itemsPerView},300)}prevSlide(){this.currentIndex--,this.updateSlider(),this.currentIndex<this.itemsPerView&&setTimeout(()=>{this.currentIndex=this.totalItems-this.itemsPerView*2,this.updateSlider(!0)},300)}prevSlide(){this.currentIndex>0&&(this.currentIndex--,this.updateSlider())}goToSlide(e){const s=Math.max(0,Math.ceil(this.totalItems/this.itemsPerView)-1);this.currentIndex=Math.max(0,Math.min(e,s)),this.updateSlider()}handleTouchStart(e){this.touchStartX=e.touches[0].clientX,this.isDragging=!0,this.startTransform=this.currentTransform,this.track?.classList.add("swiping")}handleTouchMove(e){if(!this.isDragging)return;e.preventDefault(),this.touchEndX=e.touches[0].clientX;const i=(this.touchStartX-this.touchEndX)/this.slider.offsetWidth*100,r=this.startTransform-i;this.track.style.transform=`translateX(${r}%)`}handleTouchEnd(e){if(!this.isDragging)return;this.isDragging=!1,this.track?.classList.remove("swiping");const s=this.touchStartX-this.touchEndX;Math.abs(s)>50?s>0?this.nextSlide():this.prevSlide():this.updateSlider()}handleMouseDown(e){e.preventDefault(),this.touchStartX=e.clientX,this.isDragging=!0,this.startTransform=this.currentTransform,this.track?.classList.add("swiping"),this.slider.style.cursor="grabbing"}handleMouseMove(e){if(!this.isDragging)return;e.preventDefault(),this.touchEndX=e.clientX;const i=(this.touchStartX-this.touchEndX)/this.slider.offsetWidth*100,r=this.startTransform-i;this.track.style.transform=`translateX(${r}%)`}handleMouseUp(e){if(!this.isDragging)return;this.isDragging=!1,this.track?.classList.remove("swiping"),this.slider.style.cursor="grab";const s=this.touchStartX-this.touchEndX;Math.abs(s)>50?s>0?this.nextSlide():this.prevSlide():this.updateSlider()}handleKeyPress(e){e.key==="ArrowLeft"?(e.preventDefault(),this.prevSlide()):e.key==="ArrowRight"&&(e.preventDefault(),this.nextSlide())}handleResize(){const e=this.getItemsPerView();e!==this.itemsPerView&&(this.itemsPerView=e,this.currentIndex=0,this.renderDots(),this.updateSlider())}setupResponsive(){this.slider&&(this.slider.style.cursor="grab")}openItemDetails(e){console.log("Opening details for item:",e);const s=document.querySelector(`#${e}`);if(s){s.click();return}const i=new CustomEvent("showFurnitureDetails",{detail:{id:e}});document.dispatchEvent(i),this.showItemInfo(e)}async showItemInfo(e){try{const i=(await y.get(`https://furniture-store.b.goit.study/api/furnitures/${e}`)).data;alert(`${i.name}
Price: ${i.price} грн
Description: ${i.description||"No description available"}`)}catch(s){console.error("Error fetching item details:",s),d.error({title:"Помилка",message:"Не вдалося завантажити деталі товару",position:"topRight"})}}}document.addEventListener("DOMContentLoaded",()=>{new I});document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{new I}):new I;
//# sourceMappingURL=index.js.map
