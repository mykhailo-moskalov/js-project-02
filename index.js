import{i as u,a as v,I as F,A as P,S as O,R as $}from"./assets/vendor-DzXFeRzo.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();window.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("[data-mobile-menu]"),t=document.querySelector("[data-mobile-menu-open]"),n=document.querySelector("[data-mobile-menu-close]"),s=document.querySelectorAll(".mobile-menu__link"),r=document.body;if(!e||!t)return;const o=new URL("img/sprite.svg",document.baseURI).pathname,l=(t.dataset.sprite||o).trim(),g=(t.dataset.iconClosed||"menu").trim(),M=(t.dataset.iconOpen||"x").trim(),k=a=>{const d=t.querySelector("use");if(!d)return;const y=`${l}#${a}`;try{d.setAttribute("href",y)}catch{}try{d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",y)}catch{}},R=()=>{e.classList.add("is-open"),e.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true"),r.classList.add("no-scroll"),k(M),t.setAttribute("aria-label","Закрити меню")},f=()=>{e.classList.remove("is-open"),e.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false"),r.classList.remove("no-scroll"),k(g),t.setAttribute("aria-label","Відкрити меню")};t.addEventListener("click",a=>{a.preventDefault(),t.getAttribute("aria-expanded")==="true"?f():R()}),n&&n.addEventListener("click",f),s.forEach(a=>a.addEventListener("click",f)),window.addEventListener("keydown",a=>{a.key==="Escape"&&f()}),document.addEventListener("click",a=>{const d=window.innerWidth;if(d>=768&&d<1440&&e.classList.contains("is-open")){const y=e.contains(a.target),b=t.contains(a.target)||n&&n.contains(a.target);!y&&!b&&f()}})});const N=`<li class="furniture-item" id="{idCat}">
  <div class="furniture-item-content">
    <h3 class="furniture-item-title">{nameCat}</h3>
  </div>
  <img
    srcset="
      /img/webp/categories/category-{numCat}.webp        1x,
      /img/webp/categories@2x/category-{numCat}@2x.webp 2x
    "
    src="/img/webp/categories/category-{numCat}.webp"
    alt="{altCat}"
    class="furniture-item-image"
  />
</li>`,T=`<li class="furniture-card">
  <img class="furniture-card-img" src="{srcFrn}" alt="{altFrn}" />
  <div class="furniture-card-propeties">
    <p class="furniture-card-name">{nameFrn}</p>
    <div class="furniture-card-colors">{colorHtml}</div>
    <p class="furniture-card-cost">{priceFrn} грн</p>
  </div>
  <button id="{idFrn}" class="furniture-card-button">Детальніше</button>
</li>`;async function _(e,t,n){try{return(await v.get("https://furniture-store.b.goit.study/api/categories",{})).data}catch{return[]}}async function H(e=1,t="",n){try{const s={page:e,limit:n};return t&&t!=="all-categories"&&(s.category=t),(await v.get("https://furniture-store.b.goit.study/api/furnitures",{params:s})).data}catch{return[]}}async function X(e){const t=[{_id:"all-categories",name:"Всі товари"},...e];let n=1;const s=t.map(o=>{let l=N.replace("{idCat}",o._id).replace("{nameCat}",o.name).replace("{altCat}",o.name).replaceAll("{numCat}",n);return n++,l}).join("");document.querySelector(".furniture-categories").insertAdjacentHTML("beforeend",s),S("all-categories")}async function j(){try{const e=await _();return await X(e),e}catch{return u.error({title:"Error",message:"Не удалось загрузить категории. Попробуйте позже!",position:"topRight"}),[]}}function E(){q.style.display="inline-block"}function w(){q.style.display="none"}function D(){p.style.display="block"}function m(){p.style.display="none"}function I(){x.style.display="block"}function C(){x.style.display="none"}async function L(e,t="",n,s){try{const r=await H(e,t,n);return await V(r.furnitures,s),r}catch{return m(),u.error({title:"Error",message:"Не удалось загрузить товары. Попробуйте позже!",position:"topRight"}),[]}}async function V(e,t){const n=e.map(r=>{let o="";return r.color.forEach(g=>{o+=`<span class="furniture-card-color-chek" style="display: inline-block; background-color: ${g};"></span>`}),T.replace("{srcFrn}",r.images[0]).replace("{nameFrn}",r.name).replace("{priceFrn}",r.price).replace("{idFrn}",r._id).replace("{altFrn}",r.description).replace("{colorHtml}",o)}).join("");document.querySelector(t).insertAdjacentHTML("beforeend",n),D()}function S(e){document.querySelectorAll(".furniture-item-content").forEach(s=>{s.style.border="",s.style.borderRadius=""});const n=document.getElementById(e).querySelector(".furniture-item-content");n.style.border="8px solid #6b0609",n.style.borderRadius="8px"}const i=8;let h="all-categories",c=1;const p=document.querySelector(".furniture-load-more"),x=document.querySelector(".furniture-load-no"),q=document.querySelector(".loader");C();m();E();j();L(c,h,i,".furniture-cards").then(e=>{const t=e.totalItems-c*i;p.textContent=`Показати ще ${i} з ${t}`,c*i>=e.totalItems&&(m(),I()),w()});const z=document.querySelector(".furniture-categories");z.addEventListener("click",e=>{C(),m(),c=1,h=e.target.closest(".furniture-item").getAttribute("id"),document.querySelector(".furniture-cards").innerHTML="",E(),L(c,h,i,".furniture-cards").then(t=>{S(h);const n=t.totalItems-c*i;let s=i<=n?i:n;p.textContent=`Показати ще ${s} з ${n}`,c*i>=t.totalItems&&(m(),I()),w()})});p.addEventListener("click",()=>{m(),E(),c++,L(c,h,i,".furniture-cards").then(e=>{const t=e.totalItems-c*i;let n=i<=t?i:t;p.textContent=`Показати ще ${n} з ${t}`,c*i>=e.totalItems&&(m(),I()),w()})});const U="https://furniture-store.b.goit.study/api/orders",B={refs:{openBtn:document.getElementById("test-open-modal"),closeModalBtn:document.querySelector("[data-modal-close]"),modal:document.querySelector("[data-modal]"),form:document.getElementById("order-form"),emailInput:document.getElementById("order-email"),phoneInput:document.getElementById("order-phone"),emailError:document.getElementById("email-error"),phoneError:document.getElementById("phone-error"),commentInput:document.getElementById("order-comment"),commentError:document.getElementById("comment-error")},modelId:"682f9bbf8acbdf505592ac36",color:"#1212ca",init(){if(!this.checkElements()){console.error("Не всі необхідні елементи знайдено");return}this.refs.openBtn.addEventListener("click",this.openModal.bind(this)),this.refs.closeModalBtn.addEventListener("click",this.closeModal.bind(this)),this.refs.modal.addEventListener("click",this.backdropClick.bind(this)),document.addEventListener("keydown",this.keydownHandler.bind(this)),this.refs.form.addEventListener("submit",this.handleSubmit.bind(this)),this.refs.emailInput.addEventListener("input",this.validateEmail.bind(this)),this.refs.phoneInput.addEventListener("input",this.validatePhone.bind(this)),this.refs.commentInput.addEventListener("input",this.validateComment.bind(this))},checkElements(){return[this.refs.openBtn,this.refs.closeModalBtn,this.refs.modal,this.refs.form,this.refs.emailInput,this.refs.phoneInput,this.refs.emailError,this.refs.phoneError,this.refs.commentInput,this.refs.commentError].every(t=>t!==null)},openModal(){document.body.style.overflow="hidden",document.body.classList.add("modal-open"),this.refs.modal.classList.remove("visually-hidden")},closeModal(){document.body.style.overflow="",document.body.classList.remove("modal-open"),this.refs.modal.classList.add("visually-hidden"),this.refs.form.reset(),this.clearValidationStyles()},backdropClick(e){e.target===e.currentTarget&&this.closeModal()},keydownHandler(e){e.code==="Escape"&&this.closeModal()},validateEmail(){const e=this.refs.emailInput.value.trim();return/^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$/.test(e)?(this.refs.emailInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",!0):(this.markInvalid(this.refs.emailInput),this.refs.emailError.textContent="Пошта повинна бути у форматі example@email.com",this.refs.emailError.style.display="block",!1)},validatePhone(){const e=this.refs.phoneInput.value.trim();return/^\+38\s\(\d{3}\)\s\d{3}\s\d{2}\s\d{2}$/.test(e)?(this.refs.phoneInput.classList.remove("invalid"),this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",!0):(this.markInvalid(this.refs.phoneInput),this.refs.phoneError.textContent="Телефон має бути у форматі +38 (0XX) XXX XX XX",this.refs.phoneError.style.display="block",!1)},formatPhoneNumber(e){return e.replace(/\D/g,"")},validateComment(){const e=this.refs.commentInput.value.trim();return e&&(e.length<5||e.length>256)?(this.markInvalid(this.refs.commentInput),this.refs.commentError.textContent="Коментар має містити від 5 до 256 символів",this.refs.commentError.style.display="block",!1):(this.refs.commentInput.classList.remove("invalid"),this.refs.commentError.textContent="",this.refs.commentError.style.display="none",!0)},async handleSubmit(e){e.preventDefault(),this.clearValidationStyles();let t=!0;if(this.validateEmail()||(t=!1),this.validatePhone()||(t=!1),this.validateComment()||(t=!1),!t){u.error({title:"Помилка",message:"Будь ласка, виправте помилки у формі",position:"topRight"});return}const n={email:this.refs.emailInput.value.trim(),phone:this.formatPhoneNumber(this.refs.phoneInput.value.trim()),modelId:this.modelId,color:this.color},s=this.refs.commentInput.value.trim();s&&(n.comment=s),console.log("Відправляємо дані:",n);try{const r=await fetch(U,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!r.ok){const o=await r.json();throw new Error(o.message||"Не вдалося відправити заявку")}u.success({title:"Успіх",message:"Ваша заявка відправлена!",position:"topRight"}),this.closeModal()}catch(r){console.error("Помилка при відправці:",r),u.error({title:"Помилка",message:r.message||"Помилка зʼєднання з сервером",position:"topRight"})}},markInvalid(e){e.classList.add("invalid")},clearValidationStyles(){this.refs.emailInput.classList.remove("invalid"),this.refs.phoneInput.classList.remove("invalid"),this.refs.commentInput.classList.remove("invalid"),this.refs.emailError.textContent="",this.refs.emailError.style.display="none",this.refs.phoneError.textContent="",this.refs.phoneError.style.display="none",this.refs.commentError.textContent="",this.refs.commentError.style.display="none"}};F(B.refs.phoneInput,{mask:"+38 (0\\00) 000 00 00"});document.addEventListener("DOMContentLoaded",()=>{B.init()});new P(".accordion-container",{});function Z(){document.querySelector(".loader").classList.remove("hidden")}function J(){document.querySelector(".loader").classList.add("hidden")}const A=document.querySelector(".feedback-swiper"),K=new O(A,{pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},navigation:{prevEl:".swiper-button-prev",nextEl:".swiper-button-next"},slidesPerView:1,spaceBetween:16,breakpoints:{768:{slidesPerView:2,spaceBetween:24},1440:{slidesPerView:3}}});Q();async function Q(){Z();try{const e=await G();W(e),K.update()}catch(e){u.error({title:"Помилка",message:"Не вдалося завантажити галерею відгуків. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedback:",e)}finally{J()}}async function W(e){const t=e.map(n=>`
<li class="feedback-swiper-slide swiper-slide">
  <div class="rating-list" data-score="${n.rate}"></div>
  <p class="feedback-slide-text">"${n.descr}"</p>
  <p class="feedback-slide-name">${n.name}</p>
</li>
`).join("");A.querySelector(".swiper-wrapper").insertAdjacentHTML("beforeend",t),document.querySelectorAll(".rating-list").forEach(n=>{const s=parseFloat(n.dataset.score);new $(n,{round:{down:.25,full:.75,up:.76},readOnly:!0,score:s,starType:"i"}).init()})}async function G(){try{return(await v.get("https://furniture-store.b.goit.study/api/feedbacks",{params:{page:1,limit:10}})).data.feedbacks}catch(e){u.error({title:"Помилка",message:"Не вдалося завантажити відгуки. Спробуйте пізніше.",position:"topRight"}),console.error("Error fetching feedbacks:",e)}}const Y=document.querySelectorAll("button"),ee=document.querySelectorAll("a"),te=["click","mousedown","mouseleave","mouseup","mouseleave","touchstart","touchmove","touchend","touchcancel"];te.forEach(e=>{Y.forEach(t=>{t.addEventListener(e,()=>{t.blur()})}),ee.forEach(t=>{t.addEventListener(e,()=>{t.blur()})})});
//# sourceMappingURL=index.js.map
